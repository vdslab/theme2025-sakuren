# 食べログ レストラン検索・口コミスクレイパー

このプロジェクトは、食べログのサイトからキーワードに基づいてレストランを検索し、その口コミを抽出する Python スクリプトです。

## 機能

- 指定したエリアとキーワードでレストランを検索
  - 人気順、評価の高い順、新着順でソート可能
  - 「ラーメン」「寿司」「イタリアン」などのキーワードでお店を検索
- 検索結果のレストランの口コミを取得
  - 評価の高い口コミから優先的に取得
- 抽出した情報を CSV ファイルに保存
  - レストラン名
  - 投稿者名
  - 投稿日
  - 評価点数
  - 口コミ本文
  - URL

## 必要環境

- Python 3.6 以上
- 必要なライブラリ（requirements.txt に記載）

## インストール方法

1. リポジトリをクローンまたはダウンロード
2. 必要なライブラリをインストール

```bash
pip install -r requirements.txt
```

## 使用方法

1. スクリプトを実行

```bash
python tabelog_scraper.py
```

2. プロンプトに従って以下の情報を入力

   - エリアコード/エリア名（例: A1300 または tokyo）
   - お店のキーワード（例: ラーメン, 寿司, イタリアン）
   - スクレイピングするレストラン数（デフォルト: 10）
   - ソート方法（人気順、評価の高い順、新着順）

3. スクレイピングが完了すると、結果が `results` ディレクトリ内の CSV ファイルに保存されます

## エリアコードとエリア名

スクリプトは以下の 2 種類の入力形式に対応しています：

1. エリアコード形式（例：A1300）

   - 東京: A1300 (東京都)
   - 大阪: A2700 (大阪府)
   - 京都: A2600 (京都府)
   - 北海道: A0100 (北海道)
   - 福岡: A4000 (福岡県)

2. エリア名形式（例：tokyo）
   - 東京: tokyo
   - 大阪: osaka
   - 京都: kyoto
   - 北海道: hokkaido
   - 福岡: fukuoka

その他のエリアコードやエリア名は食べログの URL から確認できます。例えば、東京の URL は `https://tabelog.com/tokyo/` で、この URL の一部（`tokyo`）がエリア名として使用できます。

## 機能の詳細

### レストラン検索

キーワードを指定してレストランを検索できます。例えば：

- `ラーメン` - ラーメン店を検索
- `寿司` - 寿司店を検索
- `イタリアン` - イタリア料理店を検索

### ソート機能

レストランの検索結果を以下の方法でソートできます：

- 人気順（デフォルト）: 食べログ上で人気のあるレストラン順
- 評価の高い順: 評価点数の高いレストラン順
- 新着順: 新しく登録されたレストラン順

また、口コミも評価の高い順に取得されるため、より質の高い口コミを優先的に見つけることができます。

### 柔軟な URL 構造対応

食べログのサイト構造変更に対応するため、複数の URL パターンを試行します。

- 古いパターン: `/dtlrvwlst/`
- 新しいパターン: `/reviews/`

### 柔軟な HTML 解析

複数の CSS セレクタを試行して、サイト構造の変更に対応します。

## 注意事項

- このスクリプトは教育目的で作成されています
- 食べログの利用規約を遵守し、過度なリクエストを送信しないようにしてください
- サーバーに負荷をかけないよう、リクエスト間に適切な待機時間を設けています
- 商用利用は避け、個人的な調査・研究目的でのみ使用してください
- 食べログのサイト構造が変更された場合でも、スクリプトは複数のパターンを試行して対応を試みますが、完全に対応できない場合もあります

## サイト構造変更時の対応

食べログのサイト構造が変更された場合は、以下の部分を確認・修正してください：

1. CSS セレクタ（例: `a.list-rst__rst-name-target`, `div.rvw-item`など）
2. URL の構造（例: `/rstLst/`, `dtlrvwlst/`など）

変更を確認するには、ブラウザの開発者ツールを使用して要素を検証し、適切なセレクタに更新してください。

## 免責事項

このスクリプトの使用によって生じたいかなる問題や損害についても、作者は責任を負いません。利用者の責任において使用してください。
